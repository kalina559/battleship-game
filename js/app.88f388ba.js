(function(){"use strict";var e={2669:function(e,t,s){var i=s(3751),n=s(641),r=s(33);const o={id:"app"},a={class:"content"},l={key:1,class:"grids"},h={class:"phase"},p={key:2,class:"modal"},c={class:"modal-content"};function d(e,t,s,i,d,u){const y=(0,n.g2)("Header"),S=(0,n.g2)("Menu"),m=(0,n.g2)("OpponentGrid"),k=(0,n.g2)("UserGrid"),g=(0,n.g2)("Help");return(0,n.uX)(),(0,n.CE)("div",o,[(0,n.bF)(y),(0,n.Lk)("div",a,[d.gameStarted?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(S,{key:0,onStartGame:u.startGame},null,8,["onStartGame"])),d.gameStarted?((0,n.uX)(),(0,n.CE)("div",l,[(0,n.Lk)("div",h,(0,r.v_)(u.gamePhaseText),1),(0,n.bF)(m,{title:"Opponent's Grid",ships:d.opponentShips,showShips:!1,shots:d.playerShots,onCellSelected:u.handleUserShot,disabled:"player"!==d.currentPlayer,feedbackMessage:d.opponentGridFeedbackMessage},null,8,["ships","shots","onCellSelected","disabled","feedbackMessage"]),(0,n.bF)(k,{title:"Player's Grid",ships:d.playerShips,shots:d.opponentShots,onShipPlaced:u.onShipPlaced,feedbackMessage:d.playerGridFeedbackMessage},null,8,["ships","shots","onShipPlaced","feedbackMessage"])])):(0,n.Q3)("",!0),(0,n.bF)(g),d.winner?((0,n.uX)(),(0,n.CE)("div",p,[(0,n.Lk)("div",c,[(0,n.Lk)("p",null,(0,r.v_)(u.winnerMessage),1),(0,n.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>u.resetGame&&u.resetGame(...e))},"Play Again")])])):(0,n.Q3)("",!0)])])}const u=e=>((0,n.Qi)("data-v-4c349408"),e=e(),(0,n.jt)(),e),y=u((()=>(0,n.Lk)("h1",null,"Battleships",-1))),S=[y];function m(e,t,s,i,r,o){return(0,n.uX)(),(0,n.CE)("header",null,S)}var k={name:"Header"},g=s(6262);const v=(0,g.A)(k,[["render",m],["__scopeId","data-v-4c349408"]]);var b=v;const f=e=>((0,n.Qi)("data-v-4a720b28"),e=e(),(0,n.jt)(),e),w={class:"grid"},C={key:0,class:"feedback"},P={class:"row"},L=f((()=>(0,n.Lk)("div",{class:"corner"},null,-1))),A={class:"row-label"},x={key:0,class:"miss-marker"},G={class:"controls"},M={class:"control-row"},E={class:"control-row"},O={class:"control-row"};function X(e,t,s,i,o,a){return(0,n.uX)(),(0,n.CE)("div",w,[(0,n.Lk)("h2",null,(0,r.v_)(s.title),1),s.feedbackMessage?((0,n.uX)(),(0,n.CE)("div",C,(0,r.v_)(s.feedbackMessage),1)):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:"grid-container",onKeydown:t[0]||(t[0]=(...e)=>a.handleKeydown&&a.handleKeydown(...e)),tabindex:"0",ref:"gridContainer"},[(0,n.Lk)("div",P,[L,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.columnLabels,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e,class:"column-label"},(0,r.v_)(e),1)))),128))]),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.rows,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:t,class:"row"},[(0,n.Lk)("div",A,(0,r.v_)(o.rowLabels[t]),1),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:(0,r.C4)(["cell",a.getCellClass(t,e.id)])},[a.isMissCell(t,e.id)?((0,n.uX)(),(0,n.CE)("span",x,"X")):(0,n.Q3)("",!0)],2)))),128))])))),128))],544),(0,n.Lk)("div",G,[(0,n.Lk)("div",M,[(0,n.Lk)("button",{onClick:t[1]||(t[1]=e=>a.handleKeydown({key:"ArrowUp"}))},"↑")]),(0,n.Lk)("div",E,[(0,n.Lk)("button",{onClick:t[2]||(t[2]=e=>a.handleKeydown({key:"ArrowLeft"}))},"←"),(0,n.Lk)("button",{onClick:t[3]||(t[3]=e=>a.handleKeydown({key:"ArrowDown"}))},"↓"),(0,n.Lk)("button",{onClick:t[4]||(t[4]=e=>a.handleKeydown({key:"ArrowRight"}))},"→")]),(0,n.Lk)("div",O,[(0,n.Lk)("button",{onClick:t[5]||(t[5]=e=>a.handleKeydown({key:"r"}))},"Rotate"),(0,n.Lk)("button",{onClick:t[6]||(t[6]=e=>a.handleKeydown({key:"Enter"}))},"Deploy")])])])}s(4114);var F={name:"UserGrid",props:{title:{type:String,required:!0},ships:{type:Array,default:()=>[]},shots:{type:Array,default:()=>[]},feedbackMessage:{type:String,default:""}},data(){return{rows:Array.from({length:10},((e,t)=>Array.from({length:10},((e,t)=>({id:t,label:""}))))),rowLabels:"ABCDEFGHIJ".split(""),columnLabels:Array.from({length:10},((e,t)=>t+1)),placedShips:[],currentShip:{size:5,coordinates:[]},currentShipDirection:"horizontal",currentShipPosition:{x:5,y:5}}},mounted(){this.initCurrentShip(),window.addEventListener("keydown",this.handleKeydown)},beforeUnmount(){window.removeEventListener("keydown",this.handleKeydown)},methods:{initCurrentShip(){this.updateCurrentShipCoordinates()},handleKeydown(e){if(0===this.currentShip.size)return;const t=e.key;switch(t){case"ArrowUp":this.moveShip(-1,0);break;case"ArrowDown":this.moveShip(1,0);break;case"ArrowLeft":this.moveShip(0,-1);break;case"ArrowRight":this.moveShip(0,1);break;case"r":case"R":this.rotateShip();break;case"Enter":this.placeShip();break}},moveShip(e,t){const s={x:this.currentShipPosition.x+e,y:this.currentShipPosition.y+t};this.currentShipPosition=s,this.updateCurrentShipCoordinates()},rotateShip(){const e="horizontal"===this.currentShipDirection?"vertical":"horizontal";this.currentShipDirection=e,this.updateCurrentShipCoordinates()},isValidPosition(e,t,s){for(let i=0;i<t;i++){const t="horizontal"===s?e.x:e.x+i,n="horizontal"===s?e.y+i:e.y;if(t<0||t>=10||n<0||n>=10||this.isOccupied(t,n)||this.isAdjacentOccupied(t,n))return!1}return!0},isOccupied(e,t){return this.placedShips.some((s=>s.coordinates.some((s=>s.x===e&&s.y===t))))},isAdjacentOccupied(e,t){const s=[{dx:-1,dy:-1},{dx:-1,dy:0},{dx:-1,dy:1},{dx:0,dy:-1},{dx:0,dy:1},{dx:1,dy:-1},{dx:1,dy:0},{dx:1,dy:1}];return s.some((s=>{const i=e+s.dx,n=t+s.dy;return i>=0&&i<10&&n>=0&&n<10&&this.isOccupied(i,n)}))},updateCurrentShipCoordinates(){this.currentShip.coordinates=Array.from({length:this.currentShip.size},((e,t)=>"horizontal"===this.currentShipDirection?{x:this.currentShipPosition.x,y:this.currentShipPosition.y+t}:{x:this.currentShipPosition.x+t,y:this.currentShipPosition.y}))},placeShip(){this.isValidPosition(this.currentShipPosition,this.currentShip.size,this.currentShipDirection)&&(this.placedShips.push({...this.currentShip}),this.$emit("shipPlaced",this.placedShips,this.currentShip.size),this.updateNextShip())},updateNextShip(){this.currentShip.size>1?this.currentShip.size--:this.currentShip={size:0,coordinates:[]},this.currentShipPosition={x:5,y:5},this.updateCurrentShipCoordinates()},getCellClass(e,t){return this.isShotCell(e,t)?this.isHitCell(e,t)?"hit-cell":"miss-cell":this.isShipCell(e,t)?"ship-cell":this.isCurrentShipCell(e,t)?this.isValidPosition(this.currentShipPosition,this.currentShip.size,this.currentShipDirection)?"valid-ship":"invalid-ship":""},isShotCell(e,t){return this.shots.some((s=>s.x===e&&s.y===t))},isHitCell(e,t){return this.shots.some((s=>s.x===e&&s.y===t&&s.isHit))},isMissCell(e,t){const s=this.shots.find((s=>s.x===e&&s.y===t));return s&&!s.isHit},isShipCell(e,t){return this.placedShips.some((s=>s.coordinates.some((s=>s.x===e&&s.y===t))))},isCurrentShipCell(e,t){return this.currentShip.coordinates.some((s=>s.x===e&&s.y===t))}}};const _=(0,g.A)(F,[["render",X],["__scopeId","data-v-4a720b28"]]);var T=_;const H=e=>((0,n.Qi)("data-v-e48bb85e"),e=e(),(0,n.jt)(),e),K={class:"grid"},j={key:0,class:"feedback"},z={class:"grid-container"},I={class:"row"},U=H((()=>(0,n.Lk)("div",{class:"corner"},null,-1))),Q={class:"row-label"},D=["onClick"],R={key:0,class:"miss-marker"};function B(e,t,s,i,o,a){return(0,n.uX)(),(0,n.CE)("div",K,[(0,n.Lk)("h2",null,(0,r.v_)(s.title),1),s.feedbackMessage?((0,n.uX)(),(0,n.CE)("div",j,(0,r.v_)(s.feedbackMessage),1)):(0,n.Q3)("",!0),(0,n.Lk)("div",z,[(0,n.Lk)("div",I,[U,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.columnLabels,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e,class:"column-label"},(0,r.v_)(e),1)))),128))]),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.rows,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:t,class:"row"},[(0,n.Lk)("div",Q,(0,r.v_)(o.rowLabels[t]),1),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:(0,r.C4)(["cell",a.getCellClass(t,e.id)]),onClick:s=>a.selectCell(t,e.id)},[a.isMissCell(t,e.id)?((0,n.uX)(),(0,n.CE)("span",R,"X")):(0,n.Q3)("",!0)],10,D)))),128))])))),128))])])}var W={name:"OpponentGrid",props:{title:{type:String,required:!0},ships:{type:Array,default:()=>[]},showShips:{type:Boolean,default:!1},shots:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},feedbackMessage:{type:String,default:""}},data(){return{rows:Array.from({length:10},((e,t)=>Array.from({length:10},((e,t)=>({id:t,label:""}))))),rowLabels:"ABCDEFGHIJ".split(""),columnLabels:Array.from({length:10},((e,t)=>t+1))}},methods:{isShipCell(e,t){return!!this.showShips&&this.ships.some((s=>s.coordinates.some((s=>s.x===e&&s.y===t))))},getCellClass(e,t){const s=this.shots.find((s=>s.x===e&&s.y===t));return s?s.isHit?"hit-cell":"miss-cell":this.isShipCell(e,t)&&this.showShips?"ship-cell":""},isHitCell(e,t){return this.shots.some((s=>s.x===e&&s.y===t&&s.isHit))},isMissCell(e,t){const s=this.shots.find((s=>s.x===e&&s.y===t));return s&&!s.isHit},selectCell(e,t){this.disabled||this.shots.some((s=>s.x===e&&s.y===t))||this.$emit("cellSelected",e,t)}}};const Y=(0,g.A)(W,[["render",B],["__scopeId","data-v-e48bb85e"]]);var V=Y;const $=e=>((0,n.Qi)("data-v-6bd1c6cc"),e=e(),(0,n.jt)(),e),q={class:"help"},J=$((()=>(0,n.Lk)("h2",null,"Help",-1))),N=$((()=>(0,n.Lk)("p",null,"Use arrows to place your ships. You can rotate them using R key. Click on the cell you want to shoot at.",-1))),Z=[J,N];function ee(e,t,s,i,r,o){return(0,n.uX)(),(0,n.CE)("div",q,Z)}var te={name:"Help"};const se=(0,g.A)(te,[["render",ee],["__scopeId","data-v-6bd1c6cc"]]);var ie=se;const ne=e=>((0,n.Qi)("data-v-38c8b021"),e=e(),(0,n.jt)(),e),re={class:"menu"},oe=ne((()=>(0,n.Lk)("h2",null,"Select AI Type",-1))),ae=ne((()=>(0,n.Lk)("option",{disabled:"",value:""},"Please select one",-1))),le=ne((()=>(0,n.Lk)("option",null,"Random",-1))),he=ne((()=>(0,n.Lk)("option",null,"Minimax",-1))),pe=ne((()=>(0,n.Lk)("option",null,"Reinforcement Learning",-1))),ce=[ae,le,he,pe];function de(e,t,s,r,o,a){return(0,n.uX)(),(0,n.CE)("div",re,[oe,(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.selectedAi=e)},ce,512),[[i.u1,o.selectedAi]]),(0,n.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>a.startGame&&a.startGame(...e))},"Start Game")])}var ue={name:"Menu",data(){return{selectedAi:""}},methods:{startGame(){this.selectedAi?this.$emit("startGame",this.selectedAi):alert("Please select an AI type.")}}};const ye=(0,g.A)(ue,[["render",de],["__scopeId","data-v-38c8b021"]]);var Se=ye,me=s(4335);const ke=me.A.create({baseURL:"https://battleshipswebapi.azurewebsites.net/api/",withCredentials:!0,headers:{"Content-Type":"application/json"}});var ge={async getOpponentShips(){const e=await ke.get("/ShipLocations/opponent");return e.data},async setUserShips(e){await ke.post("/ShipLocations/user",e)},async userShot(e){const t=await ke.post("shot/user",e);return t.data},async opponentShot(){const e=await ke.post("shot/opponent");return e.data},async getGameState(){const e=await ke.get("gamestate/get");return e.data},async clearGameState(){await ke.get("gamestate/clear")}},ve={name:"App",components:{Header:b,UserGrid:T,OpponentGrid:V,Help:ie,Menu:Se},data(){return{gameStarted:!1,selectedAi:null,gamePhase:"placingShips",playerShips:[],opponentShips:[],playerShipsSet:!1,opponentShipsSet:!1,currentPlayer:null,opponentShots:[],playerShots:[],winner:null,opponentGridFeedbackMessage:"",playerGridFeedbackMessage:""}},computed:{gamePhaseText(){switch(this.gamePhase){case"placingShips":return"Waiting for user to deploy ships";case"waitingOpponent":return"Waiting for opponent to deploy ships";case"playerTurn":return"Your turn";case"opponentTurn":return"Opponent's turn";default:return""}},winnerMessage(){return"player"===this.winner?"User won!":"AI won!"}},methods:{async startGame(e){this.selectedAi=e,this.gameStarted=!0;try{await ge.clearGameState(),this.opponentShips=await ge.getOpponentShips(),this.opponentShipsSet=!0,this.checkPhaseTransition()}catch(t){console.error("Failed to get opponent ships:",t)}},async onShipPlaced(e){if(this.playerShips=e,this.playerShipsSet=5===this.playerShips.length,this.playerShipsSet)try{await ge.setUserShips(e),this.checkPhaseTransition()}catch(t){console.error("Failed to set user ships:",t)}else this.checkPhaseTransition()},checkPhaseTransition(){this.playerShipsSet&&this.opponentShipsSet?this.determineStartingPlayer():this.playerShipsSet?this.gamePhase="waitingOpponent":this.opponentShipsSet&&(this.gamePhase="placingShips")},determineStartingPlayer(){const e=Math.random()<.5;this.currentPlayer=e?"player":"opponent",this.gamePhase=e?"playerTurn":"opponentTurn",e||this.opponentMove()},async opponentMove(){if("opponent"===this.currentPlayer)try{const e=await ge.opponentShot();await this.updateGameState(),this.playerGridFeedbackMessage=e.isHit?e.isSunk?"Opponent sunk your ship!":"Opponent hit!":"Opponent missed!"}catch(e){console.error("Failed to get opponent move:",e)}},async handleUserShot(e,t){if("player"===this.currentPlayer)try{const s=await ge.userShot({x:e,y:t});await this.updateGameState(),this.opponentGridFeedbackMessage=s.isHit?s.isSunk?"You sunk a ship!":"You hit!":"You missed!"}catch(s){console.error("Failed to handle user shot:",s)}},async updateGameState(){try{const e=await ge.getGameState();this.playerShips.splice(0,this.playerShips.length,...e.userShips),this.opponentShips.splice(0,this.opponentShips.length,...e.opponentShips),this.playerShots.splice(0,this.playerShots.length,...e.playerShots),this.opponentShots.splice(0,this.opponentShots.length,...e.opponentShots),this.checkWinCondition(e),this.switchTurn()}catch(e){console.error("Failed to update game state:",e)}},checkWinCondition(e){const t=e.userShips.every((e=>e.isSunk)),s=e.opponentShips.every((e=>e.isSunk));t?this.winner="opponent":s&&(this.winner="player")},switchTurn(){this.currentPlayer="player"===this.currentPlayer?"opponent":"player",this.gamePhase="player"===this.currentPlayer?"playerTurn":"opponentTurn","opponent"===this.currentPlayer&&setTimeout((()=>{this.opponentMove()}),1e3)},randomCoordinate(){return Math.floor(10*Math.random())},resetGame(){this.gameStarted=!1,this.selectedAi=null,this.gamePhase="placingShips",this.playerShips=[],this.opponentShips=[],this.playerShipsSet=!1,this.opponentShipsSet=!1,this.currentPlayer=null,this.opponentShots=[],this.playerShots=[],this.winner=null,this.opponentGridFeedbackMessage="",this.playerGridFeedbackMessage=""}}};const be=(0,g.A)(ve,[["render",d]]);var fe=be;(0,i.Ef)(fe).mount("#app")}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,s),r.exports}s.m=e,function(){var e=[];s.O=function(t,i,n,r){if(!i){var o=1/0;for(p=0;p<e.length;p++){i=e[p][0],n=e[p][1],r=e[p][2];for(var a=!0,l=0;l<i.length;l++)(!1&r||o>=r)&&Object.keys(s.O).every((function(e){return s.O[e](i[l])}))?i.splice(l--,1):(a=!1,r<o&&(o=r));if(a){e.splice(p--,1);var h=n();void 0!==h&&(t=h)}}return t}r=r||0;for(var p=e.length;p>0&&e[p-1][2]>r;p--)e[p]=e[p-1];e[p]=[i,n,r]}}(),function(){s.d=function(e,t){for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,i){var n,r,o=i[0],a=i[1],l=i[2],h=0;if(o.some((function(t){return 0!==e[t]}))){for(n in a)s.o(a,n)&&(s.m[n]=a[n]);if(l)var p=l(s)}for(t&&t(i);h<o.length;h++)r=o[h],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(p)},i=self["webpackChunkbattleship_game"]=self["webpackChunkbattleship_game"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=s.O(void 0,[504],(function(){return s(2669)}));i=s.O(i)})();
//# sourceMappingURL=app.88f388ba.js.map